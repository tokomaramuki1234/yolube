# Google Sheets自動更新システム セットアップガイド

## 概要
このシステムはGoogle Spreadsheetsからイベント情報を自動取得し、yolube.jp/keページの次回イベント情報を動的に更新します。

## 機能
1. 今日より未来の日付の中から最も近い日付を自動検索
2. 指定された3つの会場（秋田ベイパラダイス、みんなの実家　門脇家、秋田市文化創造館）の条件チェック
3. 条件に合わない場合、次に近い日付で再検索
4. Reactコンポーネントでリアルタイム表示

## セットアップ手順

### 1. Google Sheets API認証情報の配置

#### 方法A: 環境変数を使用（推奨）
1. `.env.example`をコピーして`.env`ファイルを作成
2. ダウンロードしたJSONファイルの内容を1行にまとめて`GOOGLE_SHEETS_CREDENTIALS`に設定

```bash
cp .env.example .env
```

#### 方法B: JSONファイルを直接配置
1. ダウンロードしたJSONファイルを`google-sheets-credentials.json`としてプロジェクトルートに配置
2. `.gitignore`に既に追加済みなので、誤ってコミットされることはありません

### 2. パッケージのインストール
```bash
npm install
```

### 3. 開発サーバーの起動
```bash
npm start
```

## システム動作

### データ取得フロー
1. **初期化**: ページ読み込み時にGoogle Sheets APIに接続
2. **データ取得**: スプレッドシートのA列〜E列を取得
3. **日付フィルタリング**: 今日より未来の日付のみを抽出
4. **会場チェック**: C列の値が指定3会場のいずれかに該当するかチェック
5. **表示**: 該当するイベントの情報を画面に表示

### エラーハンドリング
- API接続エラー時はデフォルト値を表示
- データ取得失敗時もサイトの動作は継続
- コンソールにエラーログを出力

## ファイル構成
```
src/
├── services/
│   └── googleSheets.js     # Google Sheets API管理クラス
└── pages/ke/
    └── KeLP.js            # メインコンポーネント（更新済み）

.env.example               # 環境変数テンプレート
.gitignore                # 認証情報を除外
SETUP_GUIDE.md            # このファイル
```

## トラブルシューティング

### 1. 認証エラー
- サービスアカウントのメールアドレスがスプレッドシートに共有されているか確認
- JSONファイルの形式が正しいか確認

### 2. データが表示されない
- スプレッドシートのURL/IDが正しいか確認
- A列に日付、C列に会場名、E列に回数が入力されているか確認

### 3. 日付が認識されない
- A列の日付形式を確認（YYYY/MM/DD、YYYY-MM-DD等）
- 空白行がないか確認

## 本番環境へのデプロイ

### Vercelの場合
1. Vercelダッシュボードで環境変数`GOOGLE_SHEETS_CREDENTIALS`を設定
2. JSONの内容を1行にまとめて貼り付け
3. デプロイ実行

### その他のプラットフォーム
- 各プラットフォームの環境変数設定方法に従って`GOOGLE_SHEETS_CREDENTIALS`を設定

## セキュリティ注意事項
- 認証情報を含むファイルは絶対にGitにコミットしない
- 本番環境では環境変数を使用する
- サービスアカウントには最小限の権限のみを付与する